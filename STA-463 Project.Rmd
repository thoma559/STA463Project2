---
title: "STA 463 Project 2"
author: "Justus Thomas, Mary Porter, Diksha Gulati"
date: "5/9/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## (We will delete this part later, I just wanted to add the instructions in)

1. Confirmatory multiple linear regression. Thoroughly address at least one research hypothesis or research question that is formed based on the description of the data or an initial exploration of it. This analysis can involve any hypothesis that can be tested using the methods weâ€™ve developed.

## Introduction
This project will explore a dataset concerning the 2008-2009 nine-month academic salaries for Assistant Professors, Associate Professors and Professors in a college in the U.S. The data consists of 397 observations with the predictor variables of interest as rank, discipline, years since Phd, years of service, and gender. These are all used to predict the response variable, which is the nine-month salary of professors in dollars.

The variables are defined as follows:

  * Y = salary (dollars)

  * X1 = rank (categorical: AssocProf, Asstprof, Prof)

  * X2 = discipline (categorical: A - theoretical, B - applied)

  * X3 = yrs.since.phd (years since PhD)

  * X4 = yrs.service (years of service)
  
  * X5 = sex (categorical: Female, Male) 

We will read in the data and look at the first few rows:
```{r}
salaries_data <- read.csv("~/Desktop/sta 463/salaries_data.csv")
head(salaries_data)
```

Here, we will perform a confirmatory multiple regression analysis to try to answer our hypothesis question: Does the relationship between years of service and salary differ for professors in the theoretical and applied disciplines?

## Exploratory Data Analysis (EDA)
come after the introduction, and consist of plots (i.e. scatterplots) and/or tabular summaries of the raw data (for example: means and standard deviations of X and Y). The purpose of the EDA is to familiarize you and the reader with the data and to derive insight from the initial analysis. You should include some concise commentary about what you learned from the EDA.

First, we will change the categorical predictors to be binary variables (0's and 1's) (rank will have 3 levels: Professor is level 3, Assistant Professor is level 2, and Associate Professor is 1):
```{r}
salaries_data_new <- salaries_data %>%
  mutate(discipline = ifelse(str_trim(discipline) == "A", "1", "0")) %>%
  mutate(sex = ifelse(str_trim(sex) == "Male", "1", "0")) %>% 
  mutate(discipline = as.numeric(discipline)) %>% 
  mutate(sex = as.numeric(sex))
salaries_data_new$rank <- as.numeric(as.factor(salaries_data_new$rank))
salaries_data_new
```

Then, we will look at the scatter plot matrix of our data:
```{r}
matrix <- pairs(~ salary + rank + discipline + yrs.since.phd + yrs.service + as.numeric(sex), data = salaries_data_new)
cor(cbind(salaries_data_new$salary, salaries_data_new$rank, salaries_data_new$discipline, salaries_data_new$yrs.since.phd, salaries_data_new$yrs.service, salaries_data_new$sex))
```

## Analysis
state the model (or models) you will fit and the process (if any) you used to come to a final model. Include only output that is relevant. You should also check the assumptions of the model, and if they are seriously violated you should take appropriate remedial measures if possible.

We fit the multiple linear regression model as given below:

$$Y_i=\beta_0+\beta_1X_i+\beta_2X_{ii} + \beta_3X_iX_{ii}+\epsilon_i,\ i=1,...,16$$
Here, $Y_i$ is the salary in dollars and $X_i$ is the years of service, $X_ii$ is the discipline variable that indicates if the professor works in the theoretical department (A) or the applied department (B). 
We assume that the error terms ($\epsilon_i$) are normally distributed with mean 0 and variance $\sigma^2$ and $Cov(\epsilon_i,\epsilon_j) = 0$. 
$\beta_0$ is the intercept term and $\beta_1$ is the slope for years of service, $\beta_2$ is the slope for discipline and $\beta_3$ is the interaction between years of service and discipline.

```{r}
salary.fit = lm(salary ~ yrs.service + discipline + yrs.service:discipline, data = salaries_data)
summary(salary.fit)
```

## Conclusion
communicate in clear terms the results of your analysis as they pertain to your original research hypothesis. Was it confirmed or was there a lack of evidence? Are you making your conclusion in a way that does not include unnecessary statistical jargon?
