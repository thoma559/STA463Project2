---
title: "STA 463 Project 2"
author: "Justus Thomas, Mary Porter, Diksha Gulati"
date: "5/9/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## (We will delete this part later, I just wanted to add the instructions in)

1. Confirmatory multiple linear regression. Thoroughly address at least one research hypothesis or research question that is formed based on the description of the data or an initial exploration of it. This analysis can involve any hypothesis that can be tested using the methods weâ€™ve developed.

## Introduction
This project will explore a dataset concerning the 2008-2009 nine-month academic salaries for Assistant Professors, Associate Professors and Professors in a college in the U.S. The data consists of 397 observations with the predictor variables of interest as rank, discipline, years since Phd, years of service, and gender. These are all used to predict the response variable, which is the nine-month salary of professors in dollars.

The variables are defined as follows:

  * Y = salary (dollars)

  * X1 = rank (categorical: AssocProf, Asstprof, Prof)

  * X2 = discipline (categorical: A - theoretical, B - applied)

  * X3 = yrs.since.phd (years since PhD)

  * X4 = yrs.service (years of service)
  
  * X5 = sex (categorical: Female, Male) 

We will read in the data and look at the first few rows:
```{r}
salaries_data <- read.csv("~/Desktop/sta 463/salaries_data.csv")
head(salaries_data)
```

Here, we will perform a confirmatory multiple regression analysis to try to answer our hypothesis question: Does the relationship between years of service and salary differ for professors in the theoretical and applied disciplines?

## Exploratory Data Analysis (EDA)
come after the introduction, and consist of plots (i.e. scatterplots) and/or tabular summaries of the raw data (for example: means and standard deviations of X and Y). The purpose of the EDA is to familiarize you and the reader with the data and to derive insight from the initial analysis. You should include some concise commentary about what you learned from the EDA.

First, we will change the categorical predictors to be binary variables (0's and 1's) (rank will have 3 levels: Professor is level 3, Assistant Professor is level 2, and Associate Professor is 1):
```{r}
salaries_data_new <- salaries_data %>%
  mutate(discipline = ifelse(str_trim(discipline) == "A", "1", "0")) %>%
  mutate(sex = ifelse(str_trim(sex) == "Male", "1", "0")) %>% 
  mutate(discipline = as.numeric(discipline)) %>% 
  mutate(sex = as.numeric(sex))
salaries_data_new$rank <- as.numeric(as.factor(salaries_data_new$rank))
salaries_data_new
```

Then, we will look at the scatter plot matrix of our data:
```{r}
matrix <- pairs(~ salary + rank + discipline + yrs.since.phd + yrs.service + as.numeric(sex), data = salaries_data_new)
cor(cbind(salaries_data_new$salary, salaries_data_new$rank, salaries_data_new$discipline, salaries_data_new$yrs.since.phd, salaries_data_new$yrs.service, salaries_data_new$sex))
```
From the scatter plot matrix, we can see that Years since PhD and Years of Service are highly correlated with one another. This could be a sign of multicollinearity between the predictors. This result is further proven by the correlation matrix since the correlation coefficient for Years of service and Years since PhD is 0.9, which suggests a very strong, positive linear trend between the two variables. There may also be correlation between Years since PhD and Salary, since these points follow a slight linear trend in the plots. The correlation coefficient for Salary and Years since PhD is 0.4, which suggests a fairly weak, positive linear trend between the two.

Now we will also look the distribution of salaries based on the two disciplines:
```{r}
salaries_data %>% 
  ggplot() +
  geom_boxplot(aes(y=salary, x=discipline, group=discipline))
```

From the box plots, we can see that the range of salaries for theoretical disciplines (A) and applied disciplines (B) are very similar. They both range from around +50,000 dollars to around 180,000 dollars. The mean salary for applied disciplines is slightly higher than the mean salary for theoretical disciplines. There are also more outliers in the theoretical discipline salary plot, but there is one possibly high leverage point in the applied disciplines plot that could be pulling the mean salary up towards itself.

## Analysis
state the model (or models) you will fit and the process (if any) you used to come to a final model. Include only output that is relevant. You should also check the assumptions of the model, and if they are seriously violated you should take appropriate remedial measures if possible.

We fit the multiple linear regression model as given below:

$$Y_i=\beta_0+\beta_1X_i+\beta_2X_{ii} + \beta_3X_iX_{ii}+\epsilon_i,\ i=1,...,16$$
Here, $Y_i$ is the salary in dollars and $X_i$ is the years of service, $X_ii$ is the discipline variable that indicates if the professor works in the theoretical department (A) or the applied department (B). 
We assume that the error terms ($\epsilon_i$) are normally distributed with mean 0 and variance $\sigma^2$ and $Cov(\epsilon_i,\epsilon_j) = 0$. 
$\beta_0$ is the intercept term and $\beta_1$ is the slope for years of service, $\beta_2$ is the slope for discipline and $\beta_3$ is the interaction between years of service and discipline.

```{r}
library(car)
salary.fit = lm(salary ~ yrs.service + discipline + yrs.service:discipline, data = salaries_data)
summary(salary.fit)

par(mfrow=c(2, 2))
plot(rstandard(salary.fit) ~ predict(salary.fit), data=salaries_data)
abline(h=0)
abline(h=3)
abline(h=-3)
qqnorm(rstandard(salary.fit))
abline(a=0, b=1)
hist(rstandard(salary.fit))
mtext("All Data", side = 1, line = -30, outer = TRUE)


levs=hatvalues(salary.fit)
plot(levs,ylab="leverages", xlab="observation")

dffits.mr =dffits(salary.fit)
plot(dffits.mr,ylab="DFFITS", xlab="Observation")

dfbetas.mr = dfbetas(salary.fit)
plot(dfbetas.mr[,2], ylab="DFBETAS x1")

cook.mr = cooks.distance(salary.fit)
plot(cook.mr,ylab="Cook's Distances", xlab="Observation")

vif(salary.fit)
```

According to the output, we see that the interaction term between years of service and discipline is statistically significant as the p-value for the t-test is approximately 0.001 (less than 0.05). 



The fitted model for a professor in a theoretical field would be: 

$$E(Y_i)=98038+526X_i,\ i=1,...,16$$
where $Y_i$ is the salary and $X_i$ is the years of service. 

The fitted model for a professor in an applied field would be: 
$$E(Y_i)=(98038 + 857)+(526.8 + 695.2)X_i ,\ i=1,...,16$$

We also look at the confidence interval of the interaction term between years of service and discipline. 

```{r}
confint(salary.fit)
```

We are 95% confident that for every one year increase in service, the increase in the salary of a professor in an applied field would be between 270.7427 and 1119.5875 dollars more than the increase in the salary of a professor in a theoretical field. 
Since 0 is not within the interval, we can again conclude that the relationship between years of service and salary differs for professors in applied and theoretical fields.

## Conclusion
communicate in clear terms the results of your analysis as they pertain to your original research hypothesis. Was it confirmed or was there a lack of evidence? Are you making your conclusion in a way that does not include unnecessary statistical jargon?

We can conclude that there is a significant difference between the salary of professors within in the applied field vs. the theoretical field. We can see that professors within the applied field make on average more money for every one year increase in service. This makes sense because often professors within the applied fields such as business make more because professors may be picked from the real applied work force, to teach students. Therefore these professors would require a higher salary than the theoretical professors who are more into research. Thus, professors in the theoretical field may have always been professors because they want to research so universities are less likely to have to pay more for these professors.
